此为部分源码，仅供参考
